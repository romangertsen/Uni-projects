## Описание проекта

Проект посвящён анализу сетевых данных и построению полусупервизируемой модели классификации на основе структуры графа совместных покупок книг о политике США.

Используется датасет **Political books**, представляющий сеть совместных покупок книг на Amazon во время президентских выборов в США в 2004 году. Вершины графа соответствуют книгам, а рёбра — факту совместной покупки двух книг одним пользователем. Каждая книга имеет метку идеологической принадлежности:
- liberal
- conservative
- neutral

Основная идея проекта — использовать **структуру сети** для предсказания идеологической категории книги при ограниченном числе размеченных наблюдений.

Проект сочетает:
- анализ сетевых характеристик графа,
- исследование структуры сообществ,
- построение полусупервизируемой модели классификации.

---

## Задача машинного обучения

Задача формулируется как **многоклассовая классификация узлов графа**:

**Целевая переменная:**  
идеологическая принадлежность книги

**Признаки:**  
структура графа совместных покупок (матрица смежности и сетевые связи).

Используется **semi-supervised learning**, поскольку известны метки только для части узлов.

---

## Данные

Датасет: **Political books network**

Характеристики графа:
- 105 узлов
- 441 ребро
- граф неориентированный и связный
- средняя степень вершины: 8.4
- диаметр: 8
- средняя длина кратчайшего пути: 2.92  [

---

## Исследовательский анализ графа

В ходе анализа были изучены:

### Центральности
- degree centrality
- eigenvector centrality
- closeness centrality

Наблюдения:
- либеральные книги образуют более плотную сеть
- нейтральные книги часто выступают мостами между кластерами
- консервативные книги имеют высокие значения degree centrality  

---

### Ассортативность и поляризация

Полученные результаты:
- assortativity по классу ≈ 0.72
- assortativity по степени ≈ −0.13
- dyadicity ≈ 2
- heterophilicity ≈ 0.41 

Это указывает на выраженную **политическую сегментацию сети**.

---

### Кластеризация графа

Использовались алгоритмы:
- Edge-betweenness
- Fast-greedy
- Block modelling

Результат:
- внутригрупповая плотность связей:
  - либеральные книги ≈ 74%
  - консервативные книги ≈ 68%
- межгрупповые связи редки (≈10–11%)

---

## Модель

Для предсказания идеологии книги использовался алгоритм:

**Label Propagation**

Принцип работы:
- известные метки узлов фиксируются
- вероятности классов распространяются по графу через соседей
- процесс повторяется до сходимости

Разбиение данных:
- 20% узлов — размеченные (train)
- 80% — скрытые метки (test)

Структура графа при этом полностью сохраняется.

---

## Результаты

Модель Label Propagation показала:

| Metric | Value |
|--------|-------|
| Macro-F1 | **0.749** |

Модель демонстрирует хорошее качество классификации при малом числе размеченных данных. 

---

## Выводы

В ходе проекта было показано, что:

- структура графа совместных покупок содержит значимую информацию об идеологии книг
- сеть имеет выраженную политическую сегментацию
- нейтральные книги играют роль структурных мостов между сообществами
- даже простая полусупервизируемая модель способна эффективно использовать сетевую структуру для классификации.

Модель Label Propagation показала устойчивый результат и может использоваться как базовый подход для задач классификации узлов в социальных и рекомендательных сетях.
